---
# tasks file for homelab
- name: Update package cache.
  ansible.builtin.package:
    update_cache: yes

- name: Install homelab packages.
  ansible.builtin.package:
    name: "{{ homelab_packages }}"
    state: "{{ homelab_packages_state }}"
  ignore_errors: "{{ ansible_check_mode }}"

- name: Ensure default homelab user '{{ homelab_user }}' is created
  ansible.builtin.user:
    name: "{{ homelab_user }}"
    shell: /bin/bash
    create_home: yes
    groups: docker
    append: yes

- name: Create HDD directory with specific rights
  ansible.builtin.file:
    path: /mnt/wd1tb
    state: directory
    mode: '0755'

- name: Add backup entry in fstab but donâ€™t mount
  ansible.posix.mount:
    path: /mnt/wd1tb
    src: /dev/sda1
    fstype: ext4 
    opts: defaults,nofail
    state: present
